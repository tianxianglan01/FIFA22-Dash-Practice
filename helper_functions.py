from data_cleaning import t20_paid_clubs, countries_sort, df_interest, t20_players

# notes, next time use read.csv() or import unique lists from functions
# need to clean files and function placements
# list of all country isos
iso = ["AFG",	"ALB",	"DZA",	"AND",	"AGO",	"ATG",	"ARG",	"ARM",	"AUS",	"AUT",	"AZE",	"BRB",	"BLR",	"BEL",	"BLZ",	"BEN",	
"BMU",	"BTN",	"BOL",	"BIH",	"BRA",	"BGR",	"BFA",	"BDI",	"CMR",	"CAN",	"CPV",	"CAF",	"TCD",	"CHL",	"CHN",	"TWN",	"COL",	
"COM",	"COG",	"COD",	"CRI",	"HRV",	"CUB",	"CUW",	"CYP",	"CZE",	"CIV",	"DNK",	"DOM",	"ECU",	"EGY",	"SLV",	"GBR",	"GNQ",	
"ERI",	"EST",	"ETH",	"FRO",	"FJI",	"FIN",	"FRA",	"GAB",	"GMB",	"GEO",	"DEU",	"GHA",	"GIB",	"GRC",	"GRD",	"GUM",	"GTM",	
"GIN",	"GNB",	"GUY",	"HTI",	"HND",	"HKG",	"HUN",	"ISL",	"IND",	"IDN",	"IRN",	"IRQ",	"ISR",	"ITA",	"JAM",	"JPN",	"JOR",	
"KAZ",	"KEN",	"PRK",	"KOR",	"",	    "KGZ",	"LVA",	"LBN",	"LBR",	"LBY",	"LTU",	"LUX",	"MDG",	"MWI",	"MYS",	"MLI",	"MLT",	
"MRT",	"MUS",	"MEX",	"MDA",	"MNE",	"MSR",	"MAR",	"MOZ",	"NAM",	"NLD",	"NZL",	"NER",	"NGA",	"MKD",	"GBR",	"NOR",	"PSE",	
"PAN",	"PNG",	"PRY",	"PER",	"PHL",	"POL",	"PRT",	"PRI",	"IRL",	"ROU",	"RUS",	"KNA",	"LCA",	"SAU",	"GBR",	"SEN",	"SRB",	
"SLE",	"SVK",	"SVN",	"ZAF",	"SSD",	"ESP",	"SDN",	"SUR",	"SWE",	"CHE",	"SYR",	"TZA",	"THA",	"TGO",	"TTO",	"TUN",	"TUR",	
"UGA",	"UKR",	"ARE",	"USA",	"URY",	"UZB",	"VEN",	"VNM",	"GBR",	"ZMB",	"ZWE"
]

# list of all clubs
clubs_list = ['1. FC Heidenheim 1846',	 '1. FC Kaiserslautern',	 '1. FC Köln',	 '1. FC Magdeburg',	 '1. FC Nürnberg',	 '1. FC Saarbrücken',	 '1. FC Union Berlin',	 '1. FSV Mainz 05',	 '12 de Octubre FC',	 'AC Ajaccio',	 'AC Milan',	 'AC Mineros de Guayana',	 'AC Monza',	 'AC Sparta Praha',	 'AD Alcorcón',	 'AEK Athens',	 'AFC Bournemouth',	 'AFC Chindia Târgoviște',	 'AFC UTA Arad',	 'AFC Wimbledon',	 'AIK',	 'AJ Auxerre',	 'APOEL Nicosia FC',	 'AS Monaco',	 'AS Nancy Lorraine',	 'AS Saint-Étienne',	 'ATK Mohun Bagan FC',	 'AZ Alkmaar',	 'Aalborg BK',	 'Aarhus GF',	 'Aberdeen',	 'Abha Club',	 'Academia Puerto Cabello',	 'Accrington Stanley',	 'Adana Demirspor',	 'Adelaide United',	 'Ajax',	 'Al Ahli',	 'Al Ain FC',	 'Al Batin',	 'Al Faisaly',	 'Al Fateh',	 'Al Fayha',	 'Al Hazem',	 'Al Hilal',	 'Al Ittihad',	 'Al Nassr',	 'Al Raed',	 'Al Shabab',	 'Al Taawoun',	 'Al Tai',	 'Altay SK',	 'Amiens SC',	 'América de Cali',	 'Angers SCO',	 'Antalyaspor',	 'Aragua Fútbol Club',	 'Argentinos Juniors',	 'Arsenal',	 'Arsenal de Sarandí',	 'Associação Chapecoense de Futebol',	 'Aston Villa',	 'Atakaş Hatayspor',	 'Atalanta',	 'Athletic Club de Bilbao',	 'Atlanta United',	 'Atlético Clube Goianiense',	 'Atlético Nacional',	 'Atlético Tucumán',	 'Atlético de Madrid',	 'Austin FC',	 'Avispa Fukuoka',	 'Aytemiz Alanyaspor',	 'BK Häcken',	 'BSC Young Boys',	 'Bahia',	 'Barcelona Sporting Club',	 'Barnsley',	 'Barrow',	 'Bayer 04 Leverkusen',	 'Beijing Guoan FC',	 'Belenenses SAD',	 'Benevento',	 'Bengaluru FC',	 'Beşiktaş JK',	 'Birmingham City',	 'Blackburn Rovers',	 'Blackpool',	 'Boavista FC',	 'Boca Juniors',	 'Bohemian FC',	 'Bologna',	 'Bolton Wanderers',	 'Borussia Dortmund',	 'Borussia Dortmund II',	 'Borussia Mönchengladbach',	 'Bradford City',	 'Brentford',	 'Brighton & Hove Albion',	 'Brisbane Roar',	 'Bristol City',	 'Bristol Rovers',	 'Bruk-Bet Termalica Nieciecza',	 'Brøndby IF',	 'Burgos CF',	 'Burnley',	 'Burton Albion',	 'CA Osasuna',	 'CD Antofagasta',	 'CD Huachipato',	 'CD Leganés',	 'CD Lugo',	 'CD Mirandés',	 'CD Tenerife',	 'CD Tondela',	 'CF Fuenlabrada',	 'CF Monterrey',	 'CFR Cluj',	 'CS Emelec',	 'CS Mioveni',	 'Cagliari',	 'Cambridge United',	 'Campionii FC Arges',	 'Cardiff City',	 'Carlisle United',	 'Carlos A. Mannucci',	 'Ceará Sporting Club',	 'Celtic',	 'Central Coast Mariners',	 'Centro Atlético Fénix',	 'Cerezo Osaka',	 'Cerro Largo Fútbol Club',	 'Chamois Niortais Football Club',	 'Changchun Yatai FC',	 'Charlton Athletic',	 'Chelsea',	 'Cheltenham Town',	 'Chennaiyin FC',	 'Chicago Fire Football Club',	 'Chongqing Liangjiang Athletic',	 'Clermont Foot 63',	 'Club Always Ready',	 'Club América',	 'Club Athletico Paranaense',	 'Club Atlas',	 'Club Atlético Aldosivi',	 'Club Atlético Banfield',	 'Club Atlético Central Córdoba',	 'Club Atlético Colón',	 'Club Atlético Huracán',	 'Club Atlético Independiente',	 'Club Atlético Lanús',	 'Club Atlético Nacional Potosí',	 'Club Atlético Palmaflor',	 'Club Atlético Peñarol',	 'Club Atlético Rentistas',	 'Club Atlético Sarmiento',	 'Club Atlético Talleres',	 'Club Atlético de San Luis',	 'Club Bolívar',	 'Club Brugge KV',	 'Club Cerro Porteño',	 'Club Deportes Tolima',	 'Club Deportivo Guabirá',	 'Club Deportivo Guadalajara',	 'Club Deportivo Jorge Wilstermann',	 'Club Deportivo Palestino',	 'Club Independiente Santa Fe',	 'Club León',	 'Club Libertad',	 'Club Nacional',	 'Club Nacional de Football',	 'Club Necaxa',	 'Club Olimpia',	 'Club River Plate Asunción',	 'Club Social y Deportivo Macará',	 'Club Sporting Cristal',	 'Club The Strongest',	 'Club Tijuana',	 'Club Universidad Nacional',	 'Club Universitario de Deportes',	 'Club de Deportes Cobresal',	 'Club de Foot Montréal',	 'Clube Atlético Mineiro',	 'Clube Sport Marítimo',	 'Colchester United',	 'Colorado Rapids',	 'Columbus Crew',	 'Coventry City',	 'Cracovia',	 'Crawley Town',	 'Crewe Alexandra',	 'Crotone',	 'Cruz Azul',	 'Crystal Palace',	 'Cuiabá',	 'Cádiz CF',	 'D.C. United',	 'DSC Arminia Bielefeld',	 'Daegu FC',	 'Dalian Professional Football Club',	 'Damac FC',	 'Defensa y Justicia',	 'Degerfors IF',	 'Demir Grup Sivasspor',	 'Deportivo Alavés',	 'Deportivo Cali',	 'Deportivo La Guaira FC',	 'Deportivo Pasto',	 'Deportivo Toluca',	 'Deportivo Táchira FC',	 'Derby County',	 'Derry City',	 'Dijon FCO',	 'Dinamo Zagreb',	 'Djurgårdens IF',	 'Doncaster Rovers',	 'Drogheda United',	 'Dundalk FC',	 'Dundee FC',	 'Dundee United',	 'Dynamo Kyiv',	 'ESTAC Troyes',	 'Eintracht Braunschweig',	 'Eintracht Frankfurt',	 'Elche CF',	 'Empoli',	 'En Avant de Guingamp',	 'Estoril Praia',	 'Estudiantes de La Plata',	 'Ettifaq FC',	 'Everton',	 'Exeter City',	 'F.C. Hansa Rostock',	 'F.C. København',	 'FBC Melgar',	 'FC Academica Clinceni',	 'FC Arouca',	 'FC Augsburg',	 'FC Barcelona',	 'FC Basel 1893',	 'FC Bayern München',	 'FC Botoşani',	 
'FC Cartagena',	 'FC Cincinnati',	 'FC Dallas',	 'FC Dinamo 1948 Bucureşti',	 'FC Erzgebirge Aue',	 'FC Farul Constanța',	 'FC Flyeralarm Admira',	 'FC Girondins de Bordeaux',	 'FC Goa',	 'FC Groningen',	 'FC Ingolstadt 04',	 'FC Lausanne-Sport',	 'FC Lokomotiv Moscow',	 'FC Lorient',	 'FC Lugano',	 'FC Luzern',	 'FC Metz',	 'FC Midtjylland',	 'FC Nantes',	 'FC Nordsjælland',	 'FC Paços de Ferreira',	 'FC Porto',	 'FC Red Bull Salzburg',	 'FC Schalke 04',	 'FC Seoul',	 'FC Sion',	 'FC Sochaux-Montbéliard',	 'FC St. Gallen 1879',	 'FC St. Pauli',	 'FC Tokyo',	 'FC Twente',	 'FC U Craiova 1948',	 'FC Utrecht',	 'FC Viktoria 1889 Berlin',	 'FC Viktoria Plzeň',	 'FC Vizela',	 'FC Voluntari',	 'FC Würzburger Kickers',	 'FC Zürich',	 'FCSB (Steaua)',	 'FK Austria Wien',	 'FK Bodø/Glimt',	 'FK Haugesund',	 'FSV Zwickau',	 'Fatih Karagümrük S.K.',	 'Fenerbahçe SK',	 'Ferencvárosi TC',	 'Feyenoord',	 'Finn Harps',	 'Fiorentina',	 'Flamengo',	 'Fleetwood Town',	 'Fluminense',	 'Forest Green Rovers',	 'Fortaleza',	 'Fortuna Düsseldorf',	 'Fortuna Sittard',	 'Free agent',	 'Fulham',	 'Futebol Clube de Famalicão',	 'Fútbol Club Juárez',	 'GZT Giresunspor',	 'Galatasaray SK',	 'Gallos Blancos de Querétaro',	 'Gamba Osaka',	 'Gangwon FC',	 'Gaz Metan Mediaş',	 'Gazişehir Gaziantep F.K.',	 'Genoa',	 'Getafe CF',	 'Gil Vicente FC',	 'Gillingham',	 'Gimnasia y Esgrima La Plata',	 'Girona FC',	 'Go Ahead Eagles',	 'Godoy Cruz',	 'Granada CF',	 'Grasshopper Club Zürich',	 'Grenoble Foot 38',	 'Grêmio',	 'Guaireña FC',	 'Guangzhou City',	 'Guangzhou FC',	 'Guayaquil City FC',	 'GwangJu FC',	 'Górnik Zabrze',	 'Górnik Łęczna',	 'Göztepe SK',	 'HJK Helsinki',	 'Hajduk Split',	 'Hallescher FC',	 'Halmstads BK',	 'Hamburger SV',	 'Hammarby IF',	 'Hannover 96',	 'Harrogate Town',	 'Hartlepool United',	 'Heart of Midlothian',	 'Hebei FC',	 'Hellas Verona',	 'Henan Songshan Longmen FC',	 'Heracles Almelo',	 'Hertha BSC',	 'Hibernian',	 'Hokkaido Consadole Sapporo',	 'Holstein Kiel',	 'Houston Dynamo',	 'Huddersfield Town',	 'Hull City',	 'Hyderabad FC',	 'IF Elfsborg',	 'IFK Göteborg',	 'IFK Norrköping',	 'IK Sirius',	 'Incheon United FC',	 'Independiente del Valle',	 'Inter',	 'Inter Miami CF',	 'Internacional',	 'Ipswich Town',	 'Jagiellonia Białystok',	 'Jamshedpur FC',	 'Jeju United FC',	 'Jeonbuk Hyundai Motors',	 'Junior FC',	 'Juventude',	 'Juventus',	 'K Beerschot VA',	 'KAA Gent',	 'KAS Eupen',	 'KRC Genk',	 'KSV Cercle Brugge',	 'KV Kortrijk',	 'KV Mechelen',	 'KV Oostende',	 'Kaizer Chiefs',	 'Kalmar FF',	 'Karlsruher SC',	 'Kashima Antlers',	 'Kashiwa Reysol',	 'Kasimpaşa SK',	 'Kawasaki Frontale',	 'Kerala Blasters FC',	 'Kristiansund BK',	 'LA Galaxy',	 'LASK Linz',	 'LDU Quito',	 'LOSC Lille',	 'La Equidad',	 'Lazio',	 'Le Havre AC',	 'Lecce',	 'Lech Poznań',	 'Lechia Gdańsk',	 'Leeds United',	 'Legia Warszawa',	 'Leicester City',	 'Levante Unión Deportiva',	 'Leyton Orient',	 'Lillestrøm SK',	 'Lincoln City',	 'Liverpool',	 'Livingston FC',	 'Longford Town',	 'Los Angeles FC',	 'Luton Town',	 'MSV Duisburg',	 'Macarthur FC',	 'Malmö FF',	 'Manchester City',	 'Manchester United',	 'Mansfield Town',	 'Mazatlán Futbol Club',	 'Melbourne City FC',	 'Melbourne Victory',	 'Metropolitanos de Caracas FC',	 'Middlesbrough',	 'Millwall',	 'Milton Keynes Dons',	 'Minnesota United FC',	 'Mjällby AIF',	 'Mjøndalen IF',	 'Molde FK',	 'Montevideo City Torque',	 'Montpellier Hérault SC',	 'Morecambe',	 'Moreirense FC',	 'Motherwell',	 'Mumbai City FC',	 'Málaga CF',	 'N.E.C. Nijmegen',	 'Nagoya Grampus',	 'Napoli',	 'Nashville SC',	 'New England Revolution',	 'New York City FC',	 'New York Red Bulls',	 'Newcastle Jets',	 'Newcastle United',	 "Newell's Old Boys",	 'Newport County',	 'NorthEast United FC',	 'Northampton Town',	 'Norwich City',	 'Nottingham Forest',	 'Nîmes Olympique',	 'OGC Nice',	 'Odds BK',	 'Odense Boldklub',	 'Odisha FC',	 'Oita Trinita',	 'Oldham Athletic',	 'Olympiacos CFP',	 'Olympique Lyonnais',	 'Olympique de Marseille',	 'Orlando City Soccer Club',	 'Orlando Pirates',	 'Oud-Heverlee Leuven',	 'Oxford United',	 'PAOK',	 'PEC Zwolle',	 'PFC CSKA Moscow',	 'PGE FKS Stal Mielec',	 'PSV',	 'Pachuca',	 'Palmeiras',	 'Panathinaikos FC',	 'Paris FC',	 'Paris Saint-Germain',	 'Parma',	 'Patronato',	 'Pau FC',	 'Perth Glory',	 'Peterborough United',	 'Philadelphia Union',	 'Piast Gliwice',	 'Platense',	 'Plymouth Argyle',	 'Pogoń Szczecin',	 'Pohang Steelers',	 'Port Vale',	 'Portimonense SC',	 'Portland Timbers',	 'Portsmouth',	 'Preston North End',	 'Puebla FC',	 'Qingdao FC',	 'Queens Park Rangers',	 'RB Bragantino',	 'RB Leipzig',	 'RC Celta de Vigo',	 'RC Strasbourg Alsace',	 'RCD Espanyol de Barcelona',	 'RCD Mallorca',	 'RKC Waalwijk',	 'RSC Anderlecht',	 'RZ Pellets Wolfsberger AC',	 'Racing Club',	 'Racing Club de Lens',	 'Radomiak Radom',	 
'Raków Częstochowa',	 'Randers FC',	 'Rangers FC',	 'Rapid București',	 'Rayo Vallecano',	 'Reading',	 'Real Betis Balompié',	 'Real Madrid CF',	 'Real Oviedo',	 'Real Salt Lake',	 'Real Sociedad',	 'Real Sociedad B',	 'Real Sporting de Gijón',	 'Real Valladolid CF',	 'Real Zaragoza',	 'River Plate',	 'Rochdale',	 'Rodez Aveyron Football',	 'Roma',	 'Rosario Central',	 'Rosenborg BK',	 'Ross County FC',	 'Rotherham United',	 'Royal Antwerp FC',	 'Royal Charleroi S.C.',	 'Royale Union Saint-Gilloise',	 'SC Bastia',	 'SC Braga',	 'SC Cambuur',	 'SC East Bengal FC',	 'SC Freiburg II',	 'SC Heerenveen',	 'SC Paderborn 07',	 'SC Rheindorf Altach',	 'SD Amorebieta',	 'SD Eibar',	 'SD Huesca',	 'SD Ponferradina',	 'SG Dynamo Dresden',	 'SK Austria Klagenfurt',	 'SK Brann',	 'SK Rapid Wien',	 'SK Slavia Praha',	 'SK Sturm Graz',	 'SL Benfica',	 'SSV Jahn Regensburg',	 'SV Darmstadt 98',	 'SV Meppen',	 'SV Ried',	 'SV Sandhausen',	 'SV Waldhof Mannheim 07',	 'SV Wehen Wiesbaden',	 'SV Werder Bremen',	 'SV Zulte Waregem',	 'Sagan Tosu',	 'Salford City',	 'San Jose Earthquakes',	 'San Lorenzo de Almagro',	 'Sandefjord Fotball',	 'Sanfrecce Hiroshima',	 'Santa Clara',	 'Santos',	 'Santos Laguna',	 'Sarpsborg 08 FF',	 'Scunthorpe United',	 'Seattle Sounders FC',	 'Seongnam FC',	 'Sepsi OSK Sf. Gheorghe',	 'Seraing',	 'Servette FC',	 'Sevilla FC',	 'Shakhtar Donetsk',	 'Shamrock Rovers',	 'Shandong Taishan',	 'Shanghai Port FC',	 'Shanghai Shenhua FC',	 'Sheffield United',	 'Sheffield Wednesday',	 'Shenzhen FC',	 'Shijiazhuang Ever Bright F.C.',	 'Shimizu S-Pulse',	 'Shonan Bellmare',	 'Shrewsbury Town',	 'Silkeborg IF',	 'Sint-Truidense VV',	 'Sligo Rovers',	 'Sociedad Deportiva Aucas',	 'Southampton',	 'SpVgg Greuther Fürth',	 'Sparta Rotterdam',	 'Spartak Moskva',	 'Spezia',	 'Sport Club Corinthians Paulista',	 'Sport Huancayo',	 'Sport-Club Freiburg',	 'Sportclub Verl',	 'Sporting CP',	 'Sporting Kansas City',	 'St. Johnstone FC',	 'St. Mirren',	 "St. Patrick's Athletic",	 'Stabæk Fotball',	 'Stade Brestois 29',	 'Stade Malherbe Caen',	 'Stade Rennais FC',	 'Stade de Reims',	 'Standard de Liège',	 'Stevenage',	 'Stoke City',	 'Strømsgodset IF',	 'Sunderland',	 'Sutton United',	 'Suwon FC',	 'Suwon Samsung Bluewings',	 'Swansea City',	 'Swindon Town',	 'Sydney FC',	 'São Paulo',	 'SønderjyskE',	 'TSG Hoffenheim',	 'TSV 1860 München',	 'TSV Egger Glas Hartberg',	 'TSV Havelse',	 'Tianjin Jinmen Tiger FC',	 'Tigres U.A.N.L.',	 'Tokushima Vortis',	 'Torino F.C.',	 'Toronto FC',	 'Tottenham Hotspur',	 'Toulouse Football Club',	 'Trabzonspor',	 'Tranmere Rovers',	 'Tromsø IL',	 'Türkgücü München',	 'U.C. Sampdoria',	 'U.S. Sassuolo Calcio',	 'UD Ibiza',	 'US Quevilly Rouen Métropole',	 'US Salernitana 1919',	 'USL Dunkerque',	 'Udinese Calcio',	 'Ulsan Hyundai FC',	 'Universidad Católica',	 'Universidad Técnica de Cajamarca',	 'Universitatea Craiova',	 'Unión Deportiva Almería',	 'Unión Deportiva Las Palmas',	 'Unión La Calera',	 'Unión de Santa Fe',	 'Urawa Red Diamonds',	 'Valencia CF',	 'Valenciennes FC',	 'Vancouver Whitecaps FC',	 'Varbergs BoIS FC',	 'Vegalta Sendai',	 'Vejle Boldklub',	 'Venezia FC',	 'VfB Stuttgart',	 'VfL Bochum 1848',	 'VfL Osnabrück',	 'VfL Wolfsburg',	 'Viborg FF',	 'Viking FK',	 'Viktoria Köln',	 'Villarreal CF',	 'Vissel Kobe',	 'Vitesse',	 'Vitória de Guimarães',	 'Vålerenga Fotball',	 'Vélez Sarsfield',	 'WSG Tirol',	 'Walsall',	 'Warta Poznań',	 'Waterford FC',	 'Watford',	 'Wellington Phoenix',	 'West Bromwich Albion',	 'West Ham United',	 'Western Sydney Wanderers',	 'Western United FC',	 'Wigan Athletic',	 'Willem II',	 'Wisła Kraków',	 'Wisła Płock',	 'Wolverhampton Wanderers',	 'Wrexham AFC',	 'Wuhan FC',	 'Wycombe Wanderers',	 'Yeni Malatyaspor',	 'Yokohama F. Marinos',	 'Yokohama FC',	 'Yukatel Kayserispor',	 'Zagłębie Lubin',	 'Çaykur Rizespor',	 'Örebro SK',	 'Östersunds FK',	 'İstanbul Başakşehir FK',	 'İttifak Holding Konyaspor',	 'Śląsk Wrocław']

# countries for df to map to
countries_map = {'Afghanistan': 'AFG', 'Albania': 'ALB', 'Algeria': 'DZA', 'Andorra': 'AND', 'Angola': 'AGO', 'Antigua and Barbuda': 'ATG', 'Argentina': 'ARG', 'Armenia': 'ARM', 'Australia': 'AUS', 'Austria': 'AUT', 'Azerbaijan': 'AZE', 'Barbados': 'BRB', 'Belarus': 'BLR', 'Belgium': 'BEL', 'Belize': 'BLZ', 'Benin': 'BEN', 'Bermuda': 'BMU', 'Bhutan': 'BTN', 'Bolivia': 'BOL', 'Bosnia and Herzegovina': 'BIH', 'Brazil': 'BRA', 'Bulgaria': 'BGR', 'Burkina Faso': 'BFA', 'Burundi': 'BDI', 'Cameroon': 'CMR', 'Canada': 'CAN', 'Cape Verde Islands': 'CPV', 'Central African Republic': 'CAF', 'Chad': 'TCD', 'Chile': 'CHL', 'China PR': 'CHN', 'Chinese Taipei': 'TWN', 'Colombia': 'COL', 'Comoros': 'COM', 'Congo': 'COG', 'Congo DR': 'COD', 'Costa Rica': 'CRI', 'Croatia': 'HRV', 'Cuba': 'CUB', 'Curacao': 'CUW', 'Cyprus': 'CYP', 'Czech Republic': 'CZE', "Côte d'Ivoire": 'CIV', 'Denmark': 'DNK', 'Dominican Republic': 'DOM', 'Ecuador': 'ECU', 'Egypt': 'EGY', 'El Salvador': 'SLV', 'England': 'GBR', 'Equatorial Guinea': 'GNQ', 'Eritrea': 'ERI', 'Estonia': 'EST', 'Ethiopia': 'ETH', 'Faroe Islands': 'FRO', 'Fiji': 'FJI', 'Finland': 'FIN', 'France': 'FRA', 'Gabon': 'GAB', 'Gambia': 'GMB', 'Georgia': 'GEO', 'Germany': 'DEU', 'Ghana': 'GHA', 'Gibraltar': 'GIB', 'Greece': 'GRC', 'Grenada': 'GRD', 'Guam': 'GUM', 'Guatemala': 'GTM', 'Guinea': 'GIN', 'Guinea Bissau': 
'GNB', 'Guyana': 'GUY', 'Haiti': 'HTI', 'Honduras': 'HND', 'Hong Kong': 'HKG', 'Hungary': 'HUN', 'Iceland': 'ISL', 'India': 'IND', 'Indonesia': 'IDN', 'Iran': 'IRN', 'Iraq': 'IRQ', 'Israel': 'ISR', 'Italy': 'ITA', 'Jamaica': 'JAM', 'Japan': 'JPN', 'Jordan': 'JOR', 'Kazakhstan': 'KAZ', 'Kenya': 'KEN', 'Korea DPR': 'PRK', 'Korea Republic': 'KOR', 'Kosovo': '', 'Kyrgyzstan': 'KGZ', 'Latvia': 'LVA', 'Lebanon': 'LBN', 'Liberia': 'LBR', 'Libya': 'LBY', 'Lithuania': 'LTU', 'Luxembourg': 'LUX', 'Madagascar': 'MDG', 'Malawi': 'MWI', 'Malaysia': 'MYS', 'Mali': 'MLI', 'Malta': 'MLT', 'Mauritania': 'MRT', 'Mauritius': 'MUS', 'Mexico': 'MEX', 'Moldova': 'MDA', 'Montenegro': 'MNE', 'Montserrat': 'MSR', 'Morocco': 'MAR', 'Mozambique': 'MOZ', 'Namibia': 'NAM', 'Netherlands': 'NLD', 'New Zealand': 'NZL', 'Niger': 'NER', 'Nigeria': 'NGA', 'North Macedonia': 'MKD', 'Northern Ireland': 'GBR', 'Norway': 'NOR', 'Palestine': 'PSE', 'Panama': 'PAN', 'Papua New Guinea': 'PNG', 'Paraguay': 'PRY', 'Peru': 'PER', 'Philippines': 'PHL', 'Poland': 'POL', 'Portugal': 'PRT', 'Puerto Rico': 'PRI', 'Republic of Ireland': 'IRL', 'Romania': 'ROU', 'Russia': 'RUS', 'Saint Kitts and Nevis': 'KNA', 'Saint Lucia': 'LCA', 'Saudi Arabia': 'SAU', 'Scotland': 'GBR', 'Senegal': 'SEN', 'Serbia': 'SRB', 'Sierra Leone': 'SLE', 'Slovakia': 'SVK', 'Slovenia': 'SVN', 'South Africa': 'ZAF', 'South Sudan': 'SSD', 'Spain': 'ESP', 'Sudan': 'SDN', 'Suriname': 'SUR', 'Sweden': 'SWE', 'Switzerland': 'CHE', 'Syria': 'SYR', 'Tanzania': 'TZA', 'Thailand': 'THA', 'Togo': 'TGO', 'Trinidad and Tobago': 'TTO', 'Tunisia': 'TUN', 'Turkey': 'TUR', 'Uganda': 'UGA', 'Ukraine': 'UKR', 'United Arab Emirates': 'ARE', 'United States': 'USA', 'Uruguay': 'URY', 'Uzbekistan': 'UZB', 'Venezuela': 'VEN', 'Vietnam': 'VNM', 'Wales': 'GBR', 'Zambia': 'ZMB', 'Zimbabwe': 'ZWE'}


# function to match Country name to ISO
def fill_country_options(fifa_countries, iso_list):
    # choropleth uses 3 letter ISO codes, Alpha-3
    countries = {}
    for i in range(len(fifa_countries)):
        countries[fifa_countries[i]] = iso_list[i]
    return countries
# print(fill_country_options(countries_sort(), iso))

# function to map all Player country's to ISO
def map_natl_iso(df_select):

    df = df_select.copy()
    df['natl_iso'] = df['Nationality'].map(countries_map)
    # print(df)
    return df
#print(map_natl_iso(df_interest))

# narrow it down, let's get top 20 clubs by average wage in EUR

# t20 = t20_paid_clubs()
# print(t20)

# this function creates a dictionary for the options that are used in a dropdown in app.py
def fill_club_options(lst_t20):
    options = []
    for i in lst_t20:
        current_option = {}
        current_option['label'] = i
        current_option['value'] = i
        options.append(current_option)
        # print(options)
    return options

# print(fill_club_options(t20_paid_clubs()))

t20_club_players_iso = map_natl_iso(t20_players())
t20_clubs = fill_club_options(t20_paid_clubs())
#print(t20_clubs)
#print(t20_club_players_iso)

# create column grouped by club and nationality: cell with list all players of same nationality, club for each player

def club_natl_group(t20_c_p_iso):
    t20_c_p_iso['Club Players'] = t20_c_p_iso.groupby(['Club', 'Nationality'])['FullName'].transform(lambda x: '<br>'.join(x))

    unique_club_natl = t20_c_p_iso[['Nationality', 'Club', 'Club Players', 'natl_iso']].drop_duplicates().reset_index()
    df_club_info_joined = t20_c_p_iso.merge(unique_club_natl, how = 'left', left_on = ['Nationality', 'Club'], right_on = ['Nationality', 'Club'])
    #print(df_club_info_joined.columns)
    return df_club_info_joined[['FullName', 'Nationality', 'Club', 'Club Players_x', 'natl_iso_x']]

grouped_player_clubs = club_natl_group(t20_club_players_iso)

#print(grouped_player_clubs)









